Called with args:
Namespace(cfg_file='./experiments/config/Office-31/CAN/office31_train_amazon2dslr_cfg.yaml', exp_name='office31_a2d', method='CAN', resume=None, set_cfgs=None, weights=None)
Using config:
{'ADAM': {'BETA1': 0.9, 'BETA2': 0.999},
 'CDD': {'ALIGNMENT_FEAT_KEYS': ['feat', 'probs'],
         'INTRA_ONLY': False,
         'KERNEL_MUL': [2, 2],
         'KERNEL_NUM': [5, 5],
         'LOSS_WEIGHT': 0.3},
 'CLUSTERING': {'BUDGET': 1000,
                'EPS': 0.005,
                'FEAT_KEY': 'feat',
                'FILTERING_THRESHOLD': 0.05,
                'HISTORY_LEN': 2,
                'SOURCE_BATCH_SIZE': 100,
                'TARGET_BATCH_SIZE': 100,
                'TARGET_DATASET_TYPE': 'SingleDatasetWithoutLabel'},
 'DATASET': {'DATAROOT': './experiments/dataset/Office-31',
             'NUM_CLASSES': 31,
             'SOURCE_NAME': 'amazon',
             'TARGET_NAME': 'dslr'},
 'DATA_TRANSFORM': {'FINESIZE': 224,
                    'FLIP': True,
                    'LOADSIZE': 256,
                    'NORMALIZE_MEAN': [0.485, 0.456, 0.406],
                    'NORMALIZE_STD': [0.229, 0.224, 0.225],
                    'RESIZE_OR_CROP': 'resize_and_crop',
                    'WITH_FIVE_CROP': False},
 'EVAL_METRIC': 'accuracy',
 'EXP': {'LR_DECAY_RATE': 0.1, 'LR_DECAY_STEP': 30},
 'EXP_NAME': 'office31_a2d',
 'INV': {'ALPHA': 0.001, 'BETA': 0.75},
 'MMD': {'ALIGNMENT_FEAT_KEYS': ['feat', 'probs'],
         'JOINT': False,
         'KERNEL_MUL': [2, 2],
         'KERNEL_NUM': [5, 5],
         'LOSS_WEIGHT': 0.3},
 'MODEL': {'FC_HIDDEN_DIMS': [],
           'FEATURE_EXTRACTOR': 'resnet50',
           'PRETRAINED': True},
 'NUM_WORKERS': 8,
 'RESUME': '',
 'SAVE_DIR': './experiments/ckpt',
 'TEST': {'BATCH_SIZE': 30, 'DATASET_TYPE': 'SingleDataset', 'DOMAIN': ''},
 'TRAIN': {'BASE_LR': 0.001,
           'DROPOUT_RATIO': [0.0],
           'LOGGING': True,
           'LR_MULT': 10,
           'LR_SCHEDULE': 'inv',
           'MAX_LOOP': 50,
           'MIN_SN_PER_CLASS': 3,
           'MOMENTUM': 0.9,
           'NUM_LOGGING_PER_LOOP': 6.0,
           'NUM_SELECTED_CLASSES': 10,
           'OPTIMIZER': 'SGD',
           'SAVE_CKPT_INTERVAL': 1.0,
           'SOURCE_BATCH_SIZE': 30,
           'SOURCE_CLASS_BATCH_SIZE': 3,
           'STOP_GRAD': 'layer1',
           'STOP_THRESHOLDS': [0.001, 0.001, 0.001],
           'TARGET_BATCH_SIZE': 30,
           'TARGET_CLASS_BATCH_SIZE': 3,
           'TEST_INTERVAL': 1.0,
           'UPDATE_EPOCH_PERCENTAGE': 1.0,
           'WEIGHT_DECAY': 0.0005},
 'WEIGHTS': ''}
Output will be saved to ./experiments/ckpt/office31_a2d.
Building clustering_amazon dataloader...
Building clustering_dslr dataloader...
Building amazon dataloader...
Building categorical dataloader...
Clustering based on amazon...
dist 0.0510
dist 0.0010
select 0.680723
The number of filtered classes: 30.
Iterations in one loop: 90
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
[loop: 0, iters: 14]: 
ce_loss,cdd_loss,total_loss: 2.5334,0.3511,2.8845; source accuracy: 30.0000.
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
[loop: 0, iters: 29]: 
ce_loss,cdd_loss,total_loss: 1.3563,0.4036,1.7599; source accuracy: 73.3333.
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
[loop: 0, iters: 44]: 
ce_loss,cdd_loss,total_loss: 1.3555,0.3273,1.6828; source accuracy: 70.0000.
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
[loop: 0, iters: 59]: 
ce_loss,cdd_loss,total_loss: 1.3318,0.3534,1.6852; source accuracy: 63.3333.
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
[loop: 0, iters: 74]: 
ce_loss,cdd_loss,total_loss: 1.2578,0.3189,1.5767; source accuracy: 76.6667.
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
[loop: 0, iters: 89]: 
ce_loss,cdd_loss,total_loss: 0.5587,0.2546,0.8133; source accuracy: 86.6667.
Test at (loop 0, iters: 89) with accuracy: 86.7470.
Clustering based on amazon...
dist 0.0229
dist 0.0009
select 0.558233
The number of filtered classes: 26.
Iterations in one loop: 79
Warning: masked_scatter_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (masked_scatter__cuda at /pytorch/aten/src/ATen/native/cuda/LegacyDefinitions.cpp:57)
Traceback (most recent call last):
  File "./tools/train.py", line 135, in <module>
    train(args)
  File "./tools/train.py", line 107, in train
    train_solver.solve()
  File "/home/dipesh/domain-adaptation-using-contrastive-learning/solver/can_solver.py", line 123, in solve
    self.update_network(filtered_classes)
  File "/home/dipesh/domain-adaptation-using-contrastive-learning/solver/can_solver.py", line 264, in update_network
    cdd_loss.backward()
  File "/home/dipesh/.local/lib/python3.6/site-packages/torch/tensor.py", line 195, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/dipesh/.local/lib/python3.6/site-packages/torch/autograd/__init__.py", line 99, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: cuDNN error: CUDNN_STATUS_MAPPING_ERROR

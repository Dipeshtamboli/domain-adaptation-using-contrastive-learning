['/home/dipesh/domain-adaptation-using-contrastive-learning/tools', '/home/dipesh/domain-adaptation-using-contrastive-learning', '/usr/lib/python36.zip', '/usr/lib/python3.6', '/usr/lib/python3.6/lib-dynload', '/home/dipesh/.local/lib/python3.6/site-packages', '/usr/local/lib/python3.6/dist-packages', '/usr/lib/python3/dist-packages', '/home/dipesh/.local/lib/python3.6/site-packages/IPython/extensions', './data/', './config/']
Called with args:
Namespace(cfg_file='./experiments/config/Office-31/CAN/office31_train_amazon2dslr_cfg.yaml', exp_name='office31_a2d_normal', method='CAN', resume=None, set_cfgs=None, weights=None)
Using config:
{'ADAM': {'BETA1': 0.9, 'BETA2': 0.999},
 'CDD': {'ALIGNMENT_FEAT_KEYS': ['feat', 'probs'],
         'INTRA_ONLY': False,
         'KERNEL_MUL': [2, 2],
         'KERNEL_NUM': [5, 5],
         'LOSS_WEIGHT': 0.3},
 'CLUSTERING': {'BUDGET': 1000,
                'EPS': 0.005,
                'FEAT_KEY': 'feat',
                'FILTERING_THRESHOLD': 0.05,
                'HISTORY_LEN': 2,
                'SOURCE_BATCH_SIZE': 100,
                'TARGET_BATCH_SIZE': 100,
                'TARGET_DATASET_TYPE': 'SingleDatasetWithoutLabel'},
 'DATASET': {'DATAROOT': './experiments/dataset/small_Office-31',
             'NUM_CLASSES': 31,
             'SOURCE_NAME': 'amazon',
             'TARGET_NAME': 'dslr'},
 'DATA_TRANSFORM': {'FINESIZE': 224,
                    'FLIP': True,
                    'LOADSIZE': 256,
                    'NORMALIZE_MEAN': [0.485, 0.456, 0.406],
                    'NORMALIZE_STD': [0.229, 0.224, 0.225],
                    'RESIZE_OR_CROP': 'resize_and_crop',
                    'WITH_FIVE_CROP': False},
 'EVAL_METRIC': 'accuracy',
 'EXP': {'LR_DECAY_RATE': 0.1, 'LR_DECAY_STEP': 30},
 'EXP_NAME': 'office31_a2d_normal',
 'INV': {'ALPHA': 0.001, 'BETA': 0.75},
 'MMD': {'ALIGNMENT_FEAT_KEYS': ['feat', 'probs'],
         'JOINT': False,
         'KERNEL_MUL': [2, 2],
         'KERNEL_NUM': [5, 5],
         'LOSS_WEIGHT': 0.3},
 'MODEL': {'FC_HIDDEN_DIMS': [],
           'FEATURE_EXTRACTOR': 'resnet50',
           'PRETRAINED': True},
 'NUM_WORKERS': 8,
 'RESUME': '',
 'SAVE_DIR': './experiments/ckpt',
 'TEST': {'BATCH_SIZE': 30, 'DATASET_TYPE': 'SingleDataset', 'DOMAIN': ''},
 'TRAIN': {'BASE_LR': 0.001,
           'DROPOUT_RATIO': [0.0],
           'LOGGING': True,
           'LR_MULT': 10,
           'LR_SCHEDULE': 'inv',
           'MAX_LOOP': 50,
           'MIN_SN_PER_CLASS': 3,
           'MOMENTUM': 0.9,
           'NUM_LOGGING_PER_LOOP': 6.0,
           'NUM_SELECTED_CLASSES': 10,
           'OPTIMIZER': 'SGD',
           'SAVE_CKPT_INTERVAL': 1.0,
           'SOURCE_BATCH_SIZE': 30,
           'SOURCE_CLASS_BATCH_SIZE': 3,
           'STOP_GRAD': 'layer1',
           'STOP_THRESHOLDS': [0.001, 0.001, 0.001],
           'TARGET_BATCH_SIZE': 30,
           'TARGET_CLASS_BATCH_SIZE': 3,
           'TEST_INTERVAL': 1.0,
           'UPDATE_EPOCH_PERCENTAGE': 1.0,
           'WEIGHT_DECAY': 0.0005},
 'WEIGHTS': ''}
Output will be saved to ./experiments/ckpt/office31_a2d_normal.
Building clustering_amazon dataloader...
Building clustering_dslr dataloader...
Building amazon dataloader...
Building categorical dataloader...
Clustering based on amazon...
dist 0.0660
dist 0.0008
select 0.741935
The number of filtered classes: 18.
Iterations in one loop: 6


[loop: 0, iters: 0]: 
ce_loss,cdd_loss,total_loss: 3.8018,0.3610,4.1628; source accuracy: 0.0000.


[loop: 0, iters: 1]: 
ce_loss,cdd_loss,total_loss: 3.6462,0.3015,3.9477; source accuracy: 0.0000.


[loop: 0, iters: 2]: 
ce_loss,cdd_loss,total_loss: 3.7698,0.3552,4.1250; source accuracy: 0.0000.


[loop: 0, iters: 3]: 
ce_loss,cdd_loss,total_loss: 3.4597,0.3359,3.7956; source accuracy: 10.0000.


[loop: 0, iters: 4]: 
ce_loss,cdd_loss,total_loss: 3.2744,0.3194,3.5938; source accuracy: 6.6667.


[loop: 0, iters: 5]: 
ce_loss,cdd_loss,total_loss: 3.3426,0.3272,3.6698; source accuracy: 6.6667.
Test at (loop 0, iters: 5) with accuracy: 13.7097.
Clustering based on amazon...
dist 0.0565
dist 0.0014
select 0.669355
The number of filtered classes: 17.
Iterations in one loop: 6


[loop: 1, iters: 6]: 
ce_loss,cdd_loss,total_loss: 3.0563,0.3380,3.3943; source accuracy: 10.0000.


[loop: 1, iters: 7]: 
ce_loss,cdd_loss,total_loss: 3.1929,0.3774,3.5704; source accuracy: 23.3333.


[loop: 1, iters: 8]: 
ce_loss,cdd_loss,total_loss: 3.0033,0.4520,3.4553; source accuracy: 20.0000.


[loop: 1, iters: 9]: 
ce_loss,cdd_loss,total_loss: 2.7759,0.4087,3.1847; source accuracy: 33.3333.


[loop: 1, iters: 10]: 
ce_loss,cdd_loss,total_loss: 2.4984,0.3107,2.8090; source accuracy: 50.0000.


[loop: 1, iters: 11]: 
ce_loss,cdd_loss,total_loss: 2.5931,0.3486,2.9418; source accuracy: 43.3333.
Test at (loop 1, iters: 11) with accuracy: 38.7097.
Clustering based on amazon...
dist 0.0459
dist 0.0013
select 0.548387
The number of filtered classes: 16.
Iterations in one loop: 5


[loop: 2, iters: 12]: 
ce_loss,cdd_loss,total_loss: 2.4899,0.4383,2.9282; source accuracy: 40.0000.


[loop: 2, iters: 13]: 
ce_loss,cdd_loss,total_loss: 1.5604,0.3728,1.9332; source accuracy: 73.3333.


[loop: 2, iters: 14]: 
ce_loss,cdd_loss,total_loss: 1.8071,0.3903,2.1974; source accuracy: 63.3333.


[loop: 2, iters: 15]: 
ce_loss,cdd_loss,total_loss: 1.8197,0.3978,2.2175; source accuracy: 53.3333.


[loop: 2, iters: 16]: 
ce_loss,cdd_loss,total_loss: 1.6171,0.4218,2.0389; source accuracy: 66.6667.
Test at (loop 2, iters: 16) with accuracy: 52.4194.
Clustering based on amazon...
dist 0.0469
dist 0.0015
select 0.524194
The number of filtered classes: 13.
Iterations in one loop: 4


[loop: 3, iters: 17]: 
ce_loss,cdd_loss,total_loss: 1.5097,0.3482,1.8579; source accuracy: 76.6667.


[loop: 3, iters: 18]: 
ce_loss,cdd_loss,total_loss: 1.3281,0.4094,1.7375; source accuracy: 73.3333.


[loop: 3, iters: 19]: 
ce_loss,cdd_loss,total_loss: 1.0710,0.3061,1.3772; source accuracy: 83.3333.


[loop: 3, iters: 20]: 
ce_loss,cdd_loss,total_loss: 1.1554,0.3296,1.4850; source accuracy: 76.6667.
Test at (loop 3, iters: 20) with accuracy: 62.0968.
Clustering based on amazon...
dist 0.0446
dist 0.0004
select 0.508065
The number of filtered classes: 12.
Iterations in one loop: 4


[loop: 4, iters: 21]: 
ce_loss,cdd_loss,total_loss: 1.1066,0.4612,1.5678; source accuracy: 80.0000.


[loop: 4, iters: 22]: 
ce_loss,cdd_loss,total_loss: 0.9011,0.3966,1.2977; source accuracy: 86.6667.


[loop: 4, iters: 23]: 
ce_loss,cdd_loss,total_loss: 0.7611,0.3437,1.1048; source accuracy: 83.3333.


[loop: 4, iters: 24]: 
ce_loss,cdd_loss,total_loss: 0.7519,0.3852,1.1370; source accuracy: 90.0000.
Test at (loop 4, iters: 24) with accuracy: 66.1290.
Clustering based on amazon...
dist 0.0448
dist 0.0003
select 0.508065
The number of filtered classes: 13.
Iterations in one loop: 4


[loop: 5, iters: 25]: 
ce_loss,cdd_loss,total_loss: 0.9870,0.3218,1.3088; source accuracy: 76.6667.


[loop: 5, iters: 26]: 
ce_loss,cdd_loss,total_loss: 0.8265,0.3597,1.1863; source accuracy: 83.3333.


[loop: 5, iters: 27]: 
ce_loss,cdd_loss,total_loss: 0.6965,0.3231,1.0196; source accuracy: 86.6667.


[loop: 5, iters: 28]: 
ce_loss,cdd_loss,total_loss: 0.9834,0.3662,1.3496; source accuracy: 70.0000.
Test at (loop 5, iters: 28) with accuracy: 65.3226.
Clustering based on amazon...
dist 0.0467
dist 0.0016
select 0.564516
The number of filtered classes: 15.
Iterations in one loop: 5


[loop: 6, iters: 29]: 
ce_loss,cdd_loss,total_loss: 0.5376,0.2980,0.8356; source accuracy: 83.3333.


[loop: 6, iters: 30]: 
ce_loss,cdd_loss,total_loss: 0.7103,0.3814,1.0917; source accuracy: 83.3333.


[loop: 6, iters: 31]: 
ce_loss,cdd_loss,total_loss: 0.7334,0.3480,1.0814; source accuracy: 86.6667.


[loop: 6, iters: 32]: 
ce_loss,cdd_loss,total_loss: 0.4474,0.3208,0.7683; source accuracy: 93.3333.


[loop: 6, iters: 33]: 
ce_loss,cdd_loss,total_loss: 0.3664,0.2199,0.5864; source accuracy: 100.0000.
Test at (loop 6, iters: 33) with accuracy: 67.7419.
Clustering based on amazon...
dist 0.0422
dist -0.0000
select 0.540323
The number of filtered classes: 12.
Iterations in one loop: 4


[loop: 7, iters: 34]: 
ce_loss,cdd_loss,total_loss: 0.3808,0.2503,0.6311; source accuracy: 100.0000.


[loop: 7, iters: 35]: 
ce_loss,cdd_loss,total_loss: 0.3600,0.2714,0.6314; source accuracy: 93.3333.


[loop: 7, iters: 36]: 
ce_loss,cdd_loss,total_loss: 0.3939,0.3375,0.7314; source accuracy: 90.0000.


[loop: 7, iters: 37]: 
ce_loss,cdd_loss,total_loss: 0.4086,0.1852,0.5938; source accuracy: 90.0000.
Test at (loop 7, iters: 37) with accuracy: 70.1613.
Clustering based on amazon...
dist 0.0417
dist 0.0003
select 0.548387
The number of filtered classes: 12.
Iterations in one loop: 4


[loop: 8, iters: 38]: 
ce_loss,cdd_loss,total_loss: 0.4406,0.3270,0.7677; source accuracy: 90.0000.


[loop: 8, iters: 39]: 
ce_loss,cdd_loss,total_loss: 0.3825,0.2167,0.5991; source accuracy: 96.6667.


[loop: 8, iters: 40]: 
ce_loss,cdd_loss,total_loss: 0.6542,0.2682,0.9223; source accuracy: 86.6667.


[loop: 8, iters: 41]: 
ce_loss,cdd_loss,total_loss: 0.2773,0.2203,0.4976; source accuracy: 96.6667.
Test at (loop 8, iters: 41) with accuracy: 71.7742.
Clustering based on amazon...
dist 0.0452
dist 0.0009
select 0.637097
The number of filtered classes: 15.
Iterations in one loop: 5


[loop: 9, iters: 42]: 
ce_loss,cdd_loss,total_loss: 0.3743,0.2728,0.6472; source accuracy: 93.3333.


[loop: 9, iters: 43]: 
ce_loss,cdd_loss,total_loss: 0.2523,0.2286,0.4809; source accuracy: 96.6667.


[loop: 9, iters: 44]: 
ce_loss,cdd_loss,total_loss: 0.1277,0.2724,0.4001; source accuracy: 100.0000.


[loop: 9, iters: 45]: 
ce_loss,cdd_loss,total_loss: 0.2122,0.2126,0.4248; source accuracy: 93.3333.


[loop: 9, iters: 46]: 
ce_loss,cdd_loss,total_loss: 0.2692,0.2267,0.4959; source accuracy: 96.6667.
Test at (loop 9, iters: 46) with accuracy: 72.5806.
Clustering based on amazon...
dist 0.0393
dist 0.0004
select 0.620968
The number of filtered classes: 16.
Iterations in one loop: 5


[loop: 10, iters: 47]: 
ce_loss,cdd_loss,total_loss: 0.4205,0.2478,0.6683; source accuracy: 83.3333.


[loop: 10, iters: 48]: 
ce_loss,cdd_loss,total_loss: 0.2747,0.2442,0.5189; source accuracy: 93.3333.


[loop: 10, iters: 49]: 
ce_loss,cdd_loss,total_loss: 0.3333,0.2364,0.5697; source accuracy: 90.0000.


[loop: 10, iters: 50]: 
ce_loss,cdd_loss,total_loss: 0.2533,0.1841,0.4374; source accuracy: 96.6667.


[loop: 10, iters: 51]: 
ce_loss,cdd_loss,total_loss: 0.2774,0.1220,0.3994; source accuracy: 90.0000.
Test at (loop 10, iters: 51) with accuracy: 74.1935.
Clustering based on amazon...
dist 0.0387
dist 0.0008
select 0.629032
The number of filtered classes: 16.
Iterations in one loop: 5


[loop: 11, iters: 52]: 
ce_loss,cdd_loss,total_loss: 0.2062,0.2213,0.4275; source accuracy: 100.0000.


[loop: 11, iters: 53]: 
ce_loss,cdd_loss,total_loss: 0.1817,0.2525,0.4342; source accuracy: 93.3333.


[loop: 11, iters: 54]: 
ce_loss,cdd_loss,total_loss: 0.1808,0.1807,0.3615; source accuracy: 96.6667.


[loop: 11, iters: 55]: 
ce_loss,cdd_loss,total_loss: 0.1260,0.3345,0.4604; source accuracy: 100.0000.


[loop: 11, iters: 56]: 
ce_loss,cdd_loss,total_loss: 0.1173,0.2690,0.3863; source accuracy: 96.6667.
Test at (loop 11, iters: 56) with accuracy: 68.5484.
Clustering based on amazon...
dist 0.0395
dist 0.0000
select 0.612903
The number of filtered classes: 17.
Iterations in one loop: 6


[loop: 12, iters: 57]: 
ce_loss,cdd_loss,total_loss: 0.1523,0.2877,0.4400; source accuracy: 100.0000.


[loop: 12, iters: 58]: 
ce_loss,cdd_loss,total_loss: 0.3343,0.2102,0.5445; source accuracy: 86.6667.


[loop: 12, iters: 59]: 
ce_loss,cdd_loss,total_loss: 0.1838,0.2629,0.4468; source accuracy: 96.6667.


[loop: 12, iters: 60]: 
ce_loss,cdd_loss,total_loss: 0.2959,0.2294,0.5253; source accuracy: 93.3333.


[loop: 12, iters: 61]: 
ce_loss,cdd_loss,total_loss: 0.1458,0.2109,0.3568; source accuracy: 96.6667.


[loop: 12, iters: 62]: 
ce_loss,cdd_loss,total_loss: 0.1615,0.2307,0.3922; source accuracy: 93.3333.
Test at (loop 12, iters: 62) with accuracy: 67.7419.
Clustering based on amazon...
dist 0.0434
dist 0.0011
select 0.629032
The number of filtered classes: 17.
Iterations in one loop: 6


[loop: 13, iters: 63]: 
ce_loss,cdd_loss,total_loss: 0.4105,0.1782,0.5886; source accuracy: 83.3333.


[loop: 13, iters: 64]: 
ce_loss,cdd_loss,total_loss: 0.2021,0.1223,0.3243; source accuracy: 93.3333.


[loop: 13, iters: 65]: 
ce_loss,cdd_loss,total_loss: 0.2675,0.2029,0.4704; source accuracy: 93.3333.


[loop: 13, iters: 66]: 
ce_loss,cdd_loss,total_loss: 0.1594,0.0913,0.2507; source accuracy: 93.3333.


[loop: 13, iters: 67]: 
ce_loss,cdd_loss,total_loss: 0.0624,0.2340,0.2964; source accuracy: 100.0000.


[loop: 13, iters: 68]: 
ce_loss,cdd_loss,total_loss: 0.2107,0.1651,0.3758; source accuracy: 96.6667.
Test at (loop 13, iters: 68) with accuracy: 70.1613.
Clustering based on amazon...
dist 0.0392
dist 0.0007
select 0.637097
The number of filtered classes: 14.
Iterations in one loop: 5


[loop: 14, iters: 69]: 
ce_loss,cdd_loss,total_loss: 0.1098,0.1117,0.2216; source accuracy: 100.0000.


[loop: 14, iters: 70]: 
ce_loss,cdd_loss,total_loss: 0.0576,0.1309,0.1885; source accuracy: 100.0000.


[loop: 14, iters: 71]: 
ce_loss,cdd_loss,total_loss: 0.1007,0.2442,0.3449; source accuracy: 100.0000.


[loop: 14, iters: 72]: 
ce_loss,cdd_loss,total_loss: 0.0386,0.1479,0.1865; source accuracy: 100.0000.


[loop: 14, iters: 73]: 
ce_loss,cdd_loss,total_loss: 0.0274,0.1909,0.2184; source accuracy: 100.0000.
Test at (loop 14, iters: 73) with accuracy: 67.7419.
Clustering based on amazon...
dist 0.0465
dist 0.0005
select 0.661290
The number of filtered classes: 15.
Iterations in one loop: 5


[loop: 15, iters: 74]: 
ce_loss,cdd_loss,total_loss: 0.0252,0.1661,0.1914; source accuracy: 100.0000.


[loop: 15, iters: 75]: 
ce_loss,cdd_loss,total_loss: 0.0872,0.0928,0.1800; source accuracy: 100.0000.


[loop: 15, iters: 76]: 
ce_loss,cdd_loss,total_loss: 0.0673,0.1396,0.2069; source accuracy: 100.0000.


[loop: 15, iters: 77]: 
ce_loss,cdd_loss,total_loss: 0.2423,0.1795,0.4218; source accuracy: 93.3333.


[loop: 15, iters: 78]: 
ce_loss,cdd_loss,total_loss: 0.2230,0.0483,0.2712; source accuracy: 93.3333.
Test at (loop 15, iters: 78) with accuracy: 70.1613.
Clustering based on amazon...
dist 0.0376
dist 0.0002
select 0.629032
The number of filtered classes: 17.
Iterations in one loop: 6


[loop: 16, iters: 79]: 
ce_loss,cdd_loss,total_loss: 0.0358,0.1646,0.2004; source accuracy: 100.0000.


[loop: 16, iters: 80]: 
ce_loss,cdd_loss,total_loss: 0.0396,0.1240,0.1637; source accuracy: 100.0000.


[loop: 16, iters: 81]: 
ce_loss,cdd_loss,total_loss: 0.0320,0.1808,0.2128; source accuracy: 100.0000.


[loop: 16, iters: 82]: 
ce_loss,cdd_loss,total_loss: 0.0960,0.1971,0.2931; source accuracy: 93.3333.


[loop: 16, iters: 83]: 
ce_loss,cdd_loss,total_loss: 0.0460,0.1168,0.1628; source accuracy: 100.0000.


[loop: 16, iters: 84]: 
ce_loss,cdd_loss,total_loss: 0.0283,0.1193,0.1476; source accuracy: 100.0000.
Test at (loop 16, iters: 84) with accuracy: 71.7742.
Clustering based on amazon...
dist 0.0430
dist 0.0009
select 0.661290
The number of filtered classes: 16.
Iterations in one loop: 5


[loop: 17, iters: 85]: 
ce_loss,cdd_loss,total_loss: 0.0449,0.1179,0.1628; source accuracy: 100.0000.


[loop: 17, iters: 86]: 
ce_loss,cdd_loss,total_loss: 0.0308,0.0827,0.1135; source accuracy: 100.0000.


[loop: 17, iters: 87]: 
ce_loss,cdd_loss,total_loss: 0.0417,0.0517,0.0935; source accuracy: 100.0000.


[loop: 17, iters: 88]: 
ce_loss,cdd_loss,total_loss: 0.1068,0.1098,0.2166; source accuracy: 96.6667.


[loop: 17, iters: 89]: 
ce_loss,cdd_loss,total_loss: 0.1505,0.1282,0.2786; source accuracy: 93.3333.
Test at (loop 17, iters: 89) with accuracy: 70.9677.
Clustering based on amazon...
dist 0.0389
dist 0.0002
select 0.620968
The number of filtered classes: 15.
Iterations in one loop: 5


[loop: 18, iters: 90]: 
ce_loss,cdd_loss,total_loss: 0.0974,0.0724,0.1699; source accuracy: 100.0000.


[loop: 18, iters: 91]: 
ce_loss,cdd_loss,total_loss: 0.0896,0.0897,0.1793; source accuracy: 93.3333.


[loop: 18, iters: 92]: 
ce_loss,cdd_loss,total_loss: 0.1160,0.0933,0.2093; source accuracy: 96.6667.


[loop: 18, iters: 93]: 
ce_loss,cdd_loss,total_loss: 0.0863,0.0401,0.1264; source accuracy: 100.0000.


[loop: 18, iters: 94]: 
ce_loss,cdd_loss,total_loss: 0.0505,0.0395,0.0901; source accuracy: 100.0000.
Test at (loop 18, iters: 94) with accuracy: 70.9677.
Clustering based on amazon...
dist 0.0362
dist 0.0004
select 0.637097
The number of filtered classes: 16.
Iterations in one loop: 5


[loop: 19, iters: 95]: 
ce_loss,cdd_loss,total_loss: 0.0746,0.0477,0.1223; source accuracy: 100.0000.


[loop: 19, iters: 96]: 
ce_loss,cdd_loss,total_loss: 0.0393,0.1168,0.1561; source accuracy: 100.0000.


[loop: 19, iters: 97]: 
ce_loss,cdd_loss,total_loss: 0.0989,0.0574,0.1563; source accuracy: 100.0000.


[loop: 19, iters: 98]: 
ce_loss,cdd_loss,total_loss: 0.0318,0.0838,0.1155; source accuracy: 100.0000.


[loop: 19, iters: 99]: 
ce_loss,cdd_loss,total_loss: 0.0761,-0.0094,0.0667; source accuracy: 96.6667.
Test at (loop 19, iters: 99) with accuracy: 70.1613.
Clustering based on amazon...
dist 0.0432
dist 0.0010
select 0.685484
The number of filtered classes: 16.
Iterations in one loop: 5


[loop: 20, iters: 100]: 
ce_loss,cdd_loss,total_loss: 0.0854,0.1010,0.1864; source accuracy: 96.6667.


[loop: 20, iters: 101]: 
ce_loss,cdd_loss,total_loss: 0.0216,0.0985,0.1201; source accuracy: 100.0000.


[loop: 20, iters: 102]: 
ce_loss,cdd_loss,total_loss: 0.0366,0.0305,0.0670; source accuracy: 100.0000.


[loop: 20, iters: 103]: 
ce_loss,cdd_loss,total_loss: 0.0111,0.0149,0.0260; source accuracy: 100.0000.


[loop: 20, iters: 104]: 
ce_loss,cdd_loss,total_loss: 0.0311,0.0851,0.1162; source accuracy: 100.0000.
Test at (loop 20, iters: 104) with accuracy: 70.9677.
Clustering based on amazon...
dist 0.0410
dist 0.0007
select 0.685484
The number of filtered classes: 16.
Iterations in one loop: 5


[loop: 21, iters: 105]: 
ce_loss,cdd_loss,total_loss: 0.0258,-0.0267,-0.0009; source accuracy: 100.0000.


[loop: 21, iters: 106]: 
ce_loss,cdd_loss,total_loss: 0.0470,-0.0074,0.0396; source accuracy: 100.0000.


[loop: 21, iters: 107]: 
ce_loss,cdd_loss,total_loss: 0.0342,0.0448,0.0789; source accuracy: 100.0000.


[loop: 21, iters: 108]: 
ce_loss,cdd_loss,total_loss: 0.0077,0.0309,0.0386; source accuracy: 100.0000.


[loop: 21, iters: 109]: 
ce_loss,cdd_loss,total_loss: 0.0406,0.0144,0.0550; source accuracy: 96.6667.
Test at (loop 21, iters: 109) with accuracy: 70.1613.
Clustering based on amazon...
dist 0.0362
dist 0.0002
select 0.620968
The number of filtered classes: 17.
Iterations in one loop: 6


[loop: 22, iters: 110]: 
ce_loss,cdd_loss,total_loss: 0.0226,0.0064,0.0289; source accuracy: 100.0000.


[loop: 22, iters: 111]: 
ce_loss,cdd_loss,total_loss: 0.0247,0.0108,0.0355; source accuracy: 100.0000.


[loop: 22, iters: 112]: 
ce_loss,cdd_loss,total_loss: 0.0631,0.0867,0.1498; source accuracy: 96.6667.


[loop: 22, iters: 113]: 
ce_loss,cdd_loss,total_loss: 0.0319,0.0414,0.0732; source accuracy: 100.0000.


[loop: 22, iters: 114]: 
ce_loss,cdd_loss,total_loss: 0.0408,0.0161,0.0569; source accuracy: 100.0000.


[loop: 22, iters: 115]: 
ce_loss,cdd_loss,total_loss: 0.0118,0.0031,0.0150; source accuracy: 100.0000.
Test at (loop 22, iters: 115) with accuracy: 72.5806.
Clustering based on amazon...
dist 0.0374
dist 0.0005
select 0.685484
The number of filtered classes: 20.
Iterations in one loop: 6




[loop: 23, iters: 116]: 
ce_loss,cdd_loss,total_loss: 0.0189,0.0592,0.0781; source accuracy: 100.0000.
[loop: 23, iters: 117]: 
ce_loss,cdd_loss,total_loss: 0.0198,0.1445,0.1642; source accuracy: 100.0000.




[loop: 23, iters: 118]: 
ce_loss,cdd_loss,total_loss: 0.0199,0.1238,0.1437; source accuracy: 100.0000.
[loop: 23, iters: 119]: 
ce_loss,cdd_loss,total_loss: 0.0124,0.0602,0.0726; source accuracy: 100.0000.




[loop: 23, iters: 120]: 
ce_loss,cdd_loss,total_loss: 0.0137,0.0682,0.0819; source accuracy: 100.0000.
[loop: 23, iters: 121]: 
ce_loss,cdd_loss,total_loss: 0.0309,0.1080,0.1389; source accuracy: 100.0000.
Test at (loop 23, iters: 121) with accuracy: 75.0000.
Clustering based on amazon...
dist 0.0402
dist 0.0003
select 0.661290
The number of filtered classes: 17.
Iterations in one loop: 6


[loop: 24, iters: 122]: 
ce_loss,cdd_loss,total_loss: 0.0512,0.0236,0.0748; source accuracy: 100.0000.


[loop: 24, iters: 123]: 
ce_loss,cdd_loss,total_loss: 0.0076,-0.0082,-0.0006; source accuracy: 100.0000.


[loop: 24, iters: 124]: 
ce_loss,cdd_loss,total_loss: 0.0381,0.0304,0.0684; source accuracy: 100.0000.


[loop: 24, iters: 125]: 
ce_loss,cdd_loss,total_loss: 0.0030,0.0090,0.0120; source accuracy: 100.0000.


[loop: 24, iters: 126]: 
ce_loss,cdd_loss,total_loss: 0.0056,0.0768,0.0824; source accuracy: 100.0000.


[loop: 24, iters: 127]: 
ce_loss,cdd_loss,total_loss: 0.0194,-0.0375,-0.0181; source accuracy: 100.0000.
Test at (loop 24, iters: 127) with accuracy: 77.4194.
Clustering based on amazon...
dist 0.0386
dist 0.0004
select 0.669355
The number of filtered classes: 18.
Iterations in one loop: 6


[loop: 25, iters: 128]: 
ce_loss,cdd_loss,total_loss: 0.0879,0.0749,0.1628; source accuracy: 96.6667.


[loop: 25, iters: 129]: 
ce_loss,cdd_loss,total_loss: 0.0074,-0.0241,-0.0167; source accuracy: 100.0000.


[loop: 25, iters: 130]: 
ce_loss,cdd_loss,total_loss: 0.0066,0.0127,0.0192; source accuracy: 100.0000.


[loop: 25, iters: 131]: 
ce_loss,cdd_loss,total_loss: 0.0077,0.0520,0.0597; source accuracy: 100.0000.


[loop: 25, iters: 132]: 
ce_loss,cdd_loss,total_loss: 0.0104,0.0063,0.0167; source accuracy: 100.0000.


[loop: 25, iters: 133]: 
ce_loss,cdd_loss,total_loss: 0.0101,-0.0189,-0.0089; source accuracy: 100.0000.
Test at (loop 25, iters: 133) with accuracy: 74.1935.
Clustering based on amazon...
dist 0.0347
dist 0.0002
select 0.669355
The number of filtered classes: 17.
Iterations in one loop: 6


[loop: 26, iters: 134]: 
ce_loss,cdd_loss,total_loss: 0.0101,0.0341,0.0442; source accuracy: 100.0000.


[loop: 26, iters: 135]: 
ce_loss,cdd_loss,total_loss: 0.0049,0.0002,0.0051; source accuracy: 100.0000.


[loop: 26, iters: 136]: 
ce_loss,cdd_loss,total_loss: 0.0191,-0.0354,-0.0164; source accuracy: 100.0000.


[loop: 26, iters: 137]: 
ce_loss,cdd_loss,total_loss: 0.0639,0.0101,0.0741; source accuracy: 96.6667.


[loop: 26, iters: 138]: 
ce_loss,cdd_loss,total_loss: 0.0254,0.0850,0.1104; source accuracy: 100.0000.


[loop: 26, iters: 139]: 
ce_loss,cdd_loss,total_loss: 0.0193,0.0011,0.0204; source accuracy: 100.0000.
Test at (loop 26, iters: 139) with accuracy: 71.7742.
Clustering based on amazon...
dist 0.0395
dist 0.0002
select 0.693548
The number of filtered classes: 17.
Iterations in one loop: 6


[loop: 27, iters: 140]: 
ce_loss,cdd_loss,total_loss: 0.0065,0.0573,0.0638; source accuracy: 100.0000.


[loop: 27, iters: 141]: 
ce_loss,cdd_loss,total_loss: 0.0133,-0.0260,-0.0127; source accuracy: 100.0000.


[loop: 27, iters: 142]: 
ce_loss,cdd_loss,total_loss: 0.0097,0.0067,0.0164; source accuracy: 100.0000.


[loop: 27, iters: 143]: 
ce_loss,cdd_loss,total_loss: 0.0083,-0.0009,0.0074; source accuracy: 100.0000.


[loop: 27, iters: 144]: 
ce_loss,cdd_loss,total_loss: 0.0046,-0.0253,-0.0207; source accuracy: 100.0000.


[loop: 27, iters: 145]: 
ce_loss,cdd_loss,total_loss: 0.0117,-0.0251,-0.0134; source accuracy: 100.0000.
Test at (loop 27, iters: 145) with accuracy: 74.1935.
Clustering based on amazon...
dist 0.0413
dist 0.0002
select 0.701613
The number of filtered classes: 19.
Iterations in one loop: 6


[loop: 28, iters: 146]: 
ce_loss,cdd_loss,total_loss: 0.0434,0.0940,0.1374; source accuracy: 100.0000.


[loop: 28, iters: 147]: 
ce_loss,cdd_loss,total_loss: 0.0050,0.1524,0.1574; source accuracy: 100.0000.


[loop: 28, iters: 148]: 
ce_loss,cdd_loss,total_loss: 0.0136,-0.0324,-0.0188; source accuracy: 100.0000.


[loop: 28, iters: 149]: 
ce_loss,cdd_loss,total_loss: 0.0050,0.0125,0.0175; source accuracy: 100.0000.


[loop: 28, iters: 150]: 
ce_loss,cdd_loss,total_loss: 0.0108,0.0407,0.0515; source accuracy: 100.0000.


[loop: 28, iters: 151]: 
ce_loss,cdd_loss,total_loss: 0.0104,0.0154,0.0258; source accuracy: 100.0000.
Test at (loop 28, iters: 151) with accuracy: 75.8065.
Clustering based on amazon...
dist 0.0381
dist -0.0000
select 0.709677
The number of filtered classes: 18.
Iterations in one loop: 6


[loop: 29, iters: 152]: 
ce_loss,cdd_loss,total_loss: 0.0021,-0.0297,-0.0276; source accuracy: 100.0000.


[loop: 29, iters: 153]: 
ce_loss,cdd_loss,total_loss: 0.0654,0.0312,0.0965; source accuracy: 100.0000.


[loop: 29, iters: 154]: 
ce_loss,cdd_loss,total_loss: 0.0152,0.0286,0.0438; source accuracy: 100.0000.


[loop: 29, iters: 155]: 
ce_loss,cdd_loss,total_loss: 0.0074,0.0107,0.0182; source accuracy: 100.0000.


[loop: 29, iters: 156]: 
ce_loss,cdd_loss,total_loss: 0.0352,0.0128,0.0480; source accuracy: 100.0000.


[loop: 29, iters: 157]: 
ce_loss,cdd_loss,total_loss: 0.0087,0.0277,0.0364; source accuracy: 100.0000.
Test at (loop 29, iters: 157) with accuracy: 74.1935.
Clustering based on amazon...
dist 0.0391
dist 0.0000
select 0.701613
The number of filtered classes: 17.
Iterations in one loop: 6


[loop: 30, iters: 158]: 
ce_loss,cdd_loss,total_loss: 0.0069,-0.0262,-0.0193; source accuracy: 100.0000.


[loop: 30, iters: 159]: 
ce_loss,cdd_loss,total_loss: 0.0034,-0.0145,-0.0111; source accuracy: 100.0000.


[loop: 30, iters: 160]: 
ce_loss,cdd_loss,total_loss: 0.0089,-0.0327,-0.0237; source accuracy: 100.0000.


[loop: 30, iters: 161]: 
ce_loss,cdd_loss,total_loss: 0.0128,0.0029,0.0158; source accuracy: 100.0000.


[loop: 30, iters: 162]: 
ce_loss,cdd_loss,total_loss: 0.0082,-0.0004,0.0078; source accuracy: 100.0000.


[loop: 30, iters: 163]: 
ce_loss,cdd_loss,total_loss: 0.0116,-0.0107,0.0010; source accuracy: 100.0000.
Test at (loop 30, iters: 163) with accuracy: 74.1935.
Clustering based on amazon...
dist 0.0349
dist 0.0002
select 0.693548
The number of filtered classes: 17.
Iterations in one loop: 6


[loop: 31, iters: 164]: 
ce_loss,cdd_loss,total_loss: 0.0090,-0.0271,-0.0181; source accuracy: 100.0000.


[loop: 31, iters: 165]: 
ce_loss,cdd_loss,total_loss: 0.0096,-0.0114,-0.0018; source accuracy: 100.0000.


[loop: 31, iters: 166]: 
ce_loss,cdd_loss,total_loss: 0.0062,-0.0330,-0.0268; source accuracy: 100.0000.


[loop: 31, iters: 167]: 
ce_loss,cdd_loss,total_loss: 0.0244,-0.0172,0.0072; source accuracy: 100.0000.


[loop: 31, iters: 168]: 
ce_loss,cdd_loss,total_loss: 0.0129,-0.0441,-0.0313; source accuracy: 100.0000.


[loop: 31, iters: 169]: 
ce_loss,cdd_loss,total_loss: 0.0108,-0.0203,-0.0094; source accuracy: 100.0000.
Test at (loop 31, iters: 169) with accuracy: 75.0000.
Clustering based on amazon...
dist 0.0351
dist 0.0003
select 0.693548
The number of filtered classes: 18.
Iterations in one loop: 6


[loop: 32, iters: 170]: 
ce_loss,cdd_loss,total_loss: 0.0068,0.0360,0.0428; source accuracy: 100.0000.


[loop: 32, iters: 171]: 
ce_loss,cdd_loss,total_loss: 0.0107,-0.0192,-0.0085; source accuracy: 100.0000.


[loop: 32, iters: 172]: 
ce_loss,cdd_loss,total_loss: 0.0205,-0.0069,0.0136; source accuracy: 100.0000.


[loop: 32, iters: 173]: 
ce_loss,cdd_loss,total_loss: 0.0090,0.0103,0.0193; source accuracy: 100.0000.


[loop: 32, iters: 174]: 
ce_loss,cdd_loss,total_loss: 0.0061,-0.0425,-0.0364; source accuracy: 100.0000.


[loop: 32, iters: 175]: 
ce_loss,cdd_loss,total_loss: 0.0099,-0.0482,-0.0383; source accuracy: 100.0000.
Test at (loop 32, iters: 175) with accuracy: 74.1935.
Clustering based on amazon...
dist 0.0341
dist 0.0002
select 0.685484
The number of filtered classes: 18.
Iterations in one loop: 6


[loop: 33, iters: 176]: 
ce_loss,cdd_loss,total_loss: 0.0045,0.0856,0.0901; source accuracy: 100.0000.


[loop: 33, iters: 177]: 
ce_loss,cdd_loss,total_loss: 0.0069,0.0612,0.0681; source accuracy: 100.0000.


[loop: 33, iters: 178]: 
ce_loss,cdd_loss,total_loss: 0.0027,0.0198,0.0226; source accuracy: 100.0000.


[loop: 33, iters: 179]: 
ce_loss,cdd_loss,total_loss: 0.0062,0.0085,0.0147; source accuracy: 100.0000.


[loop: 33, iters: 180]: 
ce_loss,cdd_loss,total_loss: 0.0077,-0.0141,-0.0064; source accuracy: 100.0000.


[loop: 33, iters: 181]: 
ce_loss,cdd_loss,total_loss: 0.0116,-0.0167,-0.0051; source accuracy: 100.0000.
Test at (loop 33, iters: 181) with accuracy: 73.3871.
Clustering based on amazon...
dist 0.0330
dist 0.0004
select 0.661290
The number of filtered classes: 18.
Iterations in one loop: 6


[loop: 34, iters: 182]: 
ce_loss,cdd_loss,total_loss: 0.0100,-0.0086,0.0014; source accuracy: 100.0000.


[loop: 34, iters: 183]: 
ce_loss,cdd_loss,total_loss: 0.0113,-0.0049,0.0064; source accuracy: 100.0000.


[loop: 34, iters: 184]: 
ce_loss,cdd_loss,total_loss: 0.0043,-0.0340,-0.0297; source accuracy: 100.0000.


[loop: 34, iters: 185]: 
ce_loss,cdd_loss,total_loss: 0.0145,0.0079,0.0224; source accuracy: 100.0000.


[loop: 34, iters: 186]: 
ce_loss,cdd_loss,total_loss: 0.0197,0.0226,0.0422; source accuracy: 100.0000.


[loop: 34, iters: 187]: 
ce_loss,cdd_loss,total_loss: 0.0087,-0.0182,-0.0095; source accuracy: 100.0000.
Test at (loop 34, iters: 187) with accuracy: 73.3871.
Clustering based on amazon...
dist 0.0388
dist 0.0013
select 0.717742
The number of filtered classes: 19.
Iterations in one loop: 6


[loop: 35, iters: 188]: 
ce_loss,cdd_loss,total_loss: 0.0160,0.0182,0.0341; source accuracy: 100.0000.


[loop: 35, iters: 189]: 
ce_loss,cdd_loss,total_loss: 0.0463,0.0148,0.0611; source accuracy: 100.0000.


[loop: 35, iters: 190]: 
ce_loss,cdd_loss,total_loss: 0.0197,-0.0157,0.0040; source accuracy: 100.0000.


[loop: 35, iters: 191]: 
ce_loss,cdd_loss,total_loss: 0.0124,-0.0149,-0.0026; source accuracy: 100.0000.


[loop: 35, iters: 192]: 
ce_loss,cdd_loss,total_loss: 0.0067,-0.0080,-0.0013; source accuracy: 100.0000.


[loop: 35, iters: 193]: 
ce_loss,cdd_loss,total_loss: 0.0030,-0.0196,-0.0166; source accuracy: 100.0000.
Test at (loop 35, iters: 193) with accuracy: 72.5806.
Clustering based on amazon...
dist 0.0334
dist 0.0007
select 0.709677
The number of filtered classes: 18.
Iterations in one loop: 6


[loop: 36, iters: 194]: 
ce_loss,cdd_loss,total_loss: 0.0071,0.0151,0.0222; source accuracy: 100.0000.


[loop: 36, iters: 195]: 
ce_loss,cdd_loss,total_loss: 0.0080,-0.0007,0.0073; source accuracy: 100.0000.


[loop: 36, iters: 196]: 
ce_loss,cdd_loss,total_loss: 0.0048,0.0120,0.0169; source accuracy: 100.0000.


[loop: 36, iters: 197]: 
ce_loss,cdd_loss,total_loss: 0.0239,0.0328,0.0568; source accuracy: 100.0000.


[loop: 36, iters: 198]: 
ce_loss,cdd_loss,total_loss: 0.0042,0.0433,0.0475; source accuracy: 100.0000.


[loop: 36, iters: 199]: 
ce_loss,cdd_loss,total_loss: 0.0066,-0.0055,0.0012; source accuracy: 100.0000.
Test at (loop 36, iters: 199) with accuracy: 74.1935.
Clustering based on amazon...
dist 0.0340
dist 0.0001
select 0.653226
The number of filtered classes: 17.
Iterations in one loop: 6


[loop: 37, iters: 200]: 
ce_loss,cdd_loss,total_loss: 0.0087,-0.0198,-0.0112; source accuracy: 100.0000.


[loop: 37, iters: 201]: 
ce_loss,cdd_loss,total_loss: 0.0014,-0.0140,-0.0127; source accuracy: 100.0000.


[loop: 37, iters: 202]: 
ce_loss,cdd_loss,total_loss: 0.0102,0.0025,0.0127; source accuracy: 100.0000.


[loop: 37, iters: 203]: 
ce_loss,cdd_loss,total_loss: 0.0038,-0.0161,-0.0122; source accuracy: 100.0000.


[loop: 37, iters: 204]: 
ce_loss,cdd_loss,total_loss: 0.0036,-0.0201,-0.0165; source accuracy: 100.0000.


[loop: 37, iters: 205]: 
ce_loss,cdd_loss,total_loss: 0.0109,0.0023,0.0132; source accuracy: 100.0000.
Test at (loop 37, iters: 205) with accuracy: 78.2258.
Clustering based on amazon...
dist 0.0324
dist -0.0000
select 0.653226
The number of filtered classes: 18.
Iterations in one loop: 6


[loop: 38, iters: 206]: 
ce_loss,cdd_loss,total_loss: 0.0089,0.0285,0.0374; source accuracy: 100.0000.


[loop: 38, iters: 207]: 
ce_loss,cdd_loss,total_loss: 0.0051,-0.0048,0.0003; source accuracy: 100.0000.


[loop: 38, iters: 208]: 
ce_loss,cdd_loss,total_loss: 0.0040,0.0178,0.0218; source accuracy: 100.0000.


[loop: 38, iters: 209]: 
ce_loss,cdd_loss,total_loss: 0.0084,-0.0171,-0.0087; source accuracy: 100.0000.


[loop: 38, iters: 210]: 
ce_loss,cdd_loss,total_loss: 0.0164,-0.0020,0.0144; source accuracy: 100.0000.


[loop: 38, iters: 211]: 
ce_loss,cdd_loss,total_loss: 0.0029,-0.0539,-0.0511; source accuracy: 100.0000.
Test at (loop 38, iters: 211) with accuracy: 75.8065.
Clustering based on amazon...
dist 0.0322
dist 0.0003
select 0.701613
The number of filtered classes: 19.
Iterations in one loop: 6


[loop: 39, iters: 212]: 
ce_loss,cdd_loss,total_loss: 0.0104,0.0130,0.0233; source accuracy: 100.0000.


[loop: 39, iters: 213]: 
ce_loss,cdd_loss,total_loss: 0.0056,0.0041,0.0097; source accuracy: 100.0000.


[loop: 39, iters: 214]: 
ce_loss,cdd_loss,total_loss: 0.0037,-0.0099,-0.0062; source accuracy: 100.0000.


[loop: 39, iters: 215]: 
ce_loss,cdd_loss,total_loss: 0.0046,0.0066,0.0112; source accuracy: 100.0000.


[loop: 39, iters: 216]: 
ce_loss,cdd_loss,total_loss: 0.0041,-0.0080,-0.0040; source accuracy: 100.0000.


[loop: 39, iters: 217]: 
ce_loss,cdd_loss,total_loss: 0.0056,-0.0118,-0.0062; source accuracy: 100.0000.
Test at (loop 39, iters: 217) with accuracy: 74.1935.
Clustering based on amazon...
dist 0.0369
dist 0.0003
select 0.717742
The number of filtered classes: 18.
Iterations in one loop: 6


[loop: 40, iters: 218]: 
ce_loss,cdd_loss,total_loss: 0.0095,-0.0162,-0.0067; source accuracy: 100.0000.


[loop: 40, iters: 219]: 
ce_loss,cdd_loss,total_loss: 0.0054,-0.0619,-0.0565; source accuracy: 100.0000.


[loop: 40, iters: 220]: 
ce_loss,cdd_loss,total_loss: 0.0075,-0.0224,-0.0150; source accuracy: 100.0000.


[loop: 40, iters: 221]: 
ce_loss,cdd_loss,total_loss: 0.0037,0.0060,0.0098; source accuracy: 100.0000.


[loop: 40, iters: 222]: 
ce_loss,cdd_loss,total_loss: 0.0022,-0.0336,-0.0314; source accuracy: 100.0000.


[loop: 40, iters: 223]: 
ce_loss,cdd_loss,total_loss: 0.0146,-0.0283,-0.0137; source accuracy: 100.0000.
Test at (loop 40, iters: 223) with accuracy: 73.3871.
Clustering based on amazon...
dist 0.0367
dist 0.0003
select 0.701613
The number of filtered classes: 18.
Iterations in one loop: 6


[loop: 41, iters: 224]: 
ce_loss,cdd_loss,total_loss: 0.0060,-0.0165,-0.0106; source accuracy: 100.0000.


[loop: 41, iters: 225]: 
ce_loss,cdd_loss,total_loss: 0.0042,-0.0328,-0.0286; source accuracy: 100.0000.


[loop: 41, iters: 226]: 
ce_loss,cdd_loss,total_loss: 0.0049,-0.0018,0.0031; source accuracy: 100.0000.


[loop: 41, iters: 227]: 
ce_loss,cdd_loss,total_loss: 0.0127,-0.0253,-0.0126; source accuracy: 100.0000.


[loop: 41, iters: 228]: 
ce_loss,cdd_loss,total_loss: 0.0060,-0.0104,-0.0044; source accuracy: 100.0000.


[loop: 41, iters: 229]: 
ce_loss,cdd_loss,total_loss: 0.0048,-0.0292,-0.0245; source accuracy: 100.0000.
Test at (loop 41, iters: 229) with accuracy: 72.5806.
Clustering based on amazon...
dist 0.0360
dist 0.0005
select 0.701613
The number of filtered classes: 18.
Iterations in one loop: 6


[loop: 42, iters: 230]: 
ce_loss,cdd_loss,total_loss: 0.0092,-0.0111,-0.0019; source accuracy: 100.0000.


[loop: 42, iters: 231]: 
ce_loss,cdd_loss,total_loss: 0.0072,-0.0220,-0.0147; source accuracy: 100.0000.


[loop: 42, iters: 232]: 
ce_loss,cdd_loss,total_loss: 0.0021,-0.0285,-0.0264; source accuracy: 100.0000.


[loop: 42, iters: 233]: 
ce_loss,cdd_loss,total_loss: 0.0036,-0.0485,-0.0449; source accuracy: 100.0000.


[loop: 42, iters: 234]: 
ce_loss,cdd_loss,total_loss: 0.0060,0.0037,0.0097; source accuracy: 100.0000.


[loop: 42, iters: 235]: 
ce_loss,cdd_loss,total_loss: 0.0105,-0.0212,-0.0107; source accuracy: 100.0000.
Test at (loop 42, iters: 235) with accuracy: 75.0000.
Clustering based on amazon...
dist 0.0365
dist 0.0000
select 0.725806
The number of filtered classes: 18.
Iterations in one loop: 6


[loop: 43, iters: 236]: 
ce_loss,cdd_loss,total_loss: 0.0055,0.0102,0.0157; source accuracy: 100.0000.


[loop: 43, iters: 237]: 
ce_loss,cdd_loss,total_loss: 0.0065,-0.0200,-0.0134; source accuracy: 100.0000.


[loop: 43, iters: 238]: 
ce_loss,cdd_loss,total_loss: 0.0062,0.0207,0.0269; source accuracy: 100.0000.


[loop: 43, iters: 239]: 
ce_loss,cdd_loss,total_loss: 0.0103,-0.0305,-0.0203; source accuracy: 100.0000.


[loop: 43, iters: 240]: 
ce_loss,cdd_loss,total_loss: 0.0070,0.0126,0.0196; source accuracy: 100.0000.


[loop: 43, iters: 241]: 
ce_loss,cdd_loss,total_loss: 0.0067,0.0204,0.0270; source accuracy: 100.0000.
Test at (loop 43, iters: 241) with accuracy: 74.1935.
Clustering based on amazon...
dist 0.0357
dist 0.0007
select 0.709677
The number of filtered classes: 18.
Iterations in one loop: 6


[loop: 44, iters: 242]: 
ce_loss,cdd_loss,total_loss: 0.0063,-0.0281,-0.0218; source accuracy: 100.0000.


[loop: 44, iters: 243]: 
ce_loss,cdd_loss,total_loss: 0.0057,0.0157,0.0214; source accuracy: 100.0000.


[loop: 44, iters: 244]: 
ce_loss,cdd_loss,total_loss: 0.0020,-0.0238,-0.0218; source accuracy: 100.0000.


[loop: 44, iters: 245]: 
ce_loss,cdd_loss,total_loss: 0.0090,-0.0543,-0.0453; source accuracy: 100.0000.


[loop: 44, iters: 246]: 
ce_loss,cdd_loss,total_loss: 0.0322,0.0031,0.0353; source accuracy: 100.0000.


[loop: 44, iters: 247]: 
ce_loss,cdd_loss,total_loss: 0.0050,-0.0399,-0.0348; source accuracy: 100.0000.
Test at (loop 44, iters: 247) with accuracy: 71.7742.
Clustering based on amazon...
dist 0.0342
dist 0.0001
select 0.693548
The number of filtered classes: 19.
Iterations in one loop: 6


[loop: 45, iters: 248]: 
ce_loss,cdd_loss,total_loss: 0.0029,-0.0347,-0.0318; source accuracy: 100.0000.


[loop: 45, iters: 249]: 
ce_loss,cdd_loss,total_loss: 0.0149,-0.0177,-0.0027; source accuracy: 100.0000.


[loop: 45, iters: 250]: 
ce_loss,cdd_loss,total_loss: 0.0010,0.0139,0.0149; source accuracy: 100.0000.


[loop: 45, iters: 251]: 
ce_loss,cdd_loss,total_loss: 0.0063,0.0031,0.0095; source accuracy: 100.0000.


[loop: 45, iters: 252]: 
ce_loss,cdd_loss,total_loss: 0.0153,-0.0359,-0.0206; source accuracy: 100.0000.


[loop: 45, iters: 253]: 
ce_loss,cdd_loss,total_loss: 0.0082,-0.0070,0.0012; source accuracy: 100.0000.
Test at (loop 45, iters: 253) with accuracy: 74.1935.
Clustering based on amazon...
dist 0.0355
dist 0.0003
select 0.750000
The number of filtered classes: 20.
Iterations in one loop: 6




[loop: 46, iters: 254]: 
ce_loss,cdd_loss,total_loss: 0.0017,0.0167,0.0184; source accuracy: 100.0000.
[loop: 46, iters: 255]: 
ce_loss,cdd_loss,total_loss: 0.0034,0.0256,0.0290; source accuracy: 100.0000.




[loop: 46, iters: 256]: 
ce_loss,cdd_loss,total_loss: 0.0080,0.0601,0.0681; source accuracy: 100.0000.
[loop: 46, iters: 257]: 
ce_loss,cdd_loss,total_loss: 0.0048,-0.0329,-0.0281; source accuracy: 100.0000.




[loop: 46, iters: 258]: 
ce_loss,cdd_loss,total_loss: 0.0121,-0.0100,0.0022; source accuracy: 100.0000.
[loop: 46, iters: 259]: 
ce_loss,cdd_loss,total_loss: 0.0038,0.0496,0.0534; source accuracy: 100.0000.
Test at (loop 46, iters: 259) with accuracy: 76.6129.
Clustering based on amazon...
dist 0.0352
dist 0.0002
select 0.725806
The number of filtered classes: 18.
Iterations in one loop: 6


[loop: 47, iters: 260]: 
ce_loss,cdd_loss,total_loss: 0.0040,-0.0191,-0.0151; source accuracy: 100.0000.


[loop: 47, iters: 261]: 
ce_loss,cdd_loss,total_loss: 0.0167,0.0008,0.0175; source accuracy: 100.0000.


[loop: 47, iters: 262]: 
ce_loss,cdd_loss,total_loss: 0.0010,-0.0179,-0.0169; source accuracy: 100.0000.


[loop: 47, iters: 263]: 
ce_loss,cdd_loss,total_loss: 0.0079,-0.0083,-0.0004; source accuracy: 100.0000.


[loop: 47, iters: 264]: 
ce_loss,cdd_loss,total_loss: 0.0071,-0.0060,0.0010; source accuracy: 100.0000.


[loop: 47, iters: 265]: 
ce_loss,cdd_loss,total_loss: 0.0018,-0.0149,-0.0131; source accuracy: 100.0000.
Test at (loop 47, iters: 265) with accuracy: 78.2258.
Clustering based on amazon...
dist 0.0312
dist 0.0002
select 0.677419
The number of filtered classes: 17.
Iterations in one loop: 6


[loop: 48, iters: 266]: 
ce_loss,cdd_loss,total_loss: 0.0107,-0.0125,-0.0018; source accuracy: 100.0000.


[loop: 48, iters: 267]: 
ce_loss,cdd_loss,total_loss: 0.0018,-0.0608,-0.0590; source accuracy: 100.0000.


[loop: 48, iters: 268]: 
ce_loss,cdd_loss,total_loss: 0.0021,-0.0172,-0.0151; source accuracy: 100.0000.


[loop: 48, iters: 269]: 
ce_loss,cdd_loss,total_loss: 0.0134,-0.0008,0.0125; source accuracy: 100.0000.


[loop: 48, iters: 270]: 
ce_loss,cdd_loss,total_loss: 0.0041,-0.0269,-0.0228; source accuracy: 100.0000.


[loop: 48, iters: 271]: 
ce_loss,cdd_loss,total_loss: 0.0102,-0.0014,0.0089; source accuracy: 100.0000.
Test at (loop 48, iters: 271) with accuracy: 76.6129.
Clustering based on amazon...
dist 0.0349
dist 0.0000
select 0.709677
The number of filtered classes: 19.
Iterations in one loop: 6


[loop: 49, iters: 272]: 
ce_loss,cdd_loss,total_loss: 0.0062,-0.0264,-0.0202; source accuracy: 100.0000.


[loop: 49, iters: 273]: 
ce_loss,cdd_loss,total_loss: 0.0037,-0.0091,-0.0054; source accuracy: 100.0000.


[loop: 49, iters: 274]: 
ce_loss,cdd_loss,total_loss: 0.0040,0.0145,0.0185; source accuracy: 100.0000.


[loop: 49, iters: 275]: 
ce_loss,cdd_loss,total_loss: 0.0011,0.0129,0.0140; source accuracy: 100.0000.


[loop: 49, iters: 276]: 
ce_loss,cdd_loss,total_loss: 0.0078,-0.0259,-0.0181; source accuracy: 100.0000.


[loop: 49, iters: 277]: 
ce_loss,cdd_loss,total_loss: 0.0019,0.0066,0.0085; source accuracy: 100.0000.
Test at (loop 49, iters: 277) with accuracy: 79.0323.
Clustering based on amazon...
dist 0.0338
dist 0.0003
Training Done!
Finished!
